# Set APT defaults
APT="apt --quiet --assume-yes --no-install-recommends"

# Update repositories
sudo $APT update
sudo $APT upgrade

# Install packages
sudo $APT install brightnessctl curl fzf git gpg grim i3status ifupdown \
    intel-media-va-driver kitty libgfshare-bin mutt pass pass-extension-otp \
    pinentry-gtk2 qrencode ripgrep scdaemon steghide sway swayidle swaylock \
    syncthing tomb ufw vim wireguard wl-clipboard wpasupplicant \
    xdg-desktop-portal-wlr xwayland zbar-tools zsh

# Remove installed packages
sudo $APT remove --purge --auto-remove gdm3 snapd bluez ubuntu-session \
    gvfs-daemons gnome* cups* language-pack-en language-pack-en-base \
    language-pack-gnome-en language-pack-gnome-en-base netplan.io \
    network-manager plymouth* sssd sssd-common ubuntu-wallpapers* \
    unattended-upgrades xserver-xorg-video-intel

# Cleanup
sudo $APT autoremove
sudo $APT autoclean

# Set locale
printf "en_US.UTF-8 UTF-8\n" | sudo tee /etc/locale.gen > /dev/null \
    && sudo locale-gen \
    && printf "LANG=en_US.UTF-8\nLANGUAGE=en_US.UTF-8\nLC_ALL=en_US.UTF-8\n" | sudo tee /etc/default/locale > /dev/null

# Change shell to ZSH
chsh --shell /usr/bin/zsh

# Add user to VIDEO group to allow brightness control
sudo usermod -aG video $USER

# Fix mouse pointer in Firefox
gsettings set org.gnome.desktop.interface cursor-theme 'DMZ-White'
